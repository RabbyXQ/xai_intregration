# Android Permissions with Numerical Priority by Grok 3 (xAI)
# Date: March 15, 2025
# Prioritized based on SHAP values

# Define permission categories as dictionaries with numerical priorities based on SHAP values
normal_permissions = {
    25: "ACCESS_WIFI_STATE",
    24: "RECEIVE_BOOT_COMPLETED",
    23: "WAKE_LOCK",
    22: "ACCESS_NETWORK_STATE",
    21: "INTERNET",
    20: "FOREGROUND_SERVICE",
    19: "CHANGE_WIFI_STATE",
    18: "VIBRATE",
    17: "KILL_BACKGROUND_PROCESSES",
    16: "CHANGE_NETWORK_STATE",
    15: "SET_WALLPAPER",
    14: "MODIFY_AUDIO_SETTINGS",
    13: "READ_SYNC_SETTINGS",
    12: "BLUETOOTH",
    11: "NFC",
    10: "REQUEST_IGNORE_BATTERY_OPTIMIZATIONS",
    9: "USE_FINGERPRINT",
    8: "REORDER_TASKS",
    7: "EXPAND_STATUS_BAR",
    6: "USE_BIOMETRIC",
    5: "READ_SYNC_STATS",
    4: "SET_WALLPAPER_HINTS",
    3: "TRANSMIT_IR",
    2: "REQUEST_COMPANION_RUN_IN_BACKGROUND",
    1: "BLUETOOTH_ADMIN"
}

dangerous_permissions = {
    55: "READ_PHONE_STATE",
    54: "SEND_SMS",
    53: "RECEIVE_SMS",
    52: "ACCESS_FINE_LOCATION",
    51: "WRITE_EXTERNAL_STORAGE",
    50: "ACCESS_COARSE_LOCATION",
    49: "GET_ACCOUNTS",
    48: "READ_SMS",
    47: "CALL_PHONE",
    46: "READ_CONTACTS",
    45: "READ_EXTERNAL_STORAGE",
    44: "RECEIVE_WAP_PUSH",
    43: "WRITE_CONTACTS",
    42: "CAMERA",
    41: "RECORD_AUDIO",
    40: "PROCESS_OUTGOING_CALLS",
    39: "READ_CALENDAR",
    38: "RECEIVE_MMS",
    37: "WRITE_CALENDAR",
    36: "READ_CALL_LOG",
    35: "WRITE_CALL_LOG",
    34: "BODY_SENSORS",
    33: "ANSWER_PHONE_CALLS",
    32: "ACCESS_BACKGROUND_LOCATION",
    31: "READ_PHONE_NUMBERS",
    30: "ACTIVITY_RECOGNITION",
    29: "USE_SIP",
    28: "ACCESS_MEDIA_LOCATION",
    27: "ACCEPT_HANDOVER",
    26: "ADD_VOICEMAIL"
}

special_permissions = {
    65: "SYSTEM_ALERT_WINDOW",
    64: "WRITE_SETTINGS",
    63: "REQUEST_INSTALL_PACKAGES",
    62: "WRITE_SECURE_SETTINGS",
    61: "ACCESS_NOTIFICATION_POLICY",
    60: "MANAGE_EXTERNAL_STORAGE",
    59: "POST_NOTIFICATIONS",
    58: "NEARBY_WIFI_DEVICES",
    57: "BLUETOOTH_SCAN",
    56: "BLUETOOTH_CONNECT",
    55: "BLUETOOTH_ADVERTISE",
    54: "UWB_RANGING"
}

signature_permissions = {
    113: "BIND_DEVICE_ADMIN",
    112: "INSTALL_PACKAGES",
    111: "MOUNT_UNMOUNT_FILESYSTEMS",
    110: "READ_LOGS",
    109: "BIND_WALLPAPER",
    108: "REBOOT",
    107: "CONTROL_LOCATION_UPDATES",
    106: "WRITE_APN_SETTINGS",
    105: "DELETE_PACKAGES",
    104: "CALL_PRIVILEGED",
    103: "BIND_VPN_SERVICE",
    102: "BROADCAST_SMS",
    101: "MANAGE_DOCUMENTS",
    100: "GET_PACKAGE_SIZE",
    99: "BIND_ACCESSIBILITY_SERVICE",
    98: "BROADCAST_WAP_PUSH",
    97: "UPDATE_DEVICE_STATS",
    96: "ACCOUNT_MANAGER",
    95: "DELETE_CACHE_FILES",
    94: "BIND_INPUT_METHOD",
    93: "BIND_PRINT_SERVICE",
    92: "SET_PREFERRED_APPLICATIONS",
    91: "CHANGE_COMPONENT_ENABLED_STATE",
    90: "BIND_APPWIDGET",
    89: "GLOBAL_SEARCH",
    88: "MEDIA_CONTENT_CONTROL",
    87: "BIND_TELECOM_CONNECTION_SERVICE",
    86: "DUMP",
    85: "ACCESS_CHECKIN_PROPERTIES",
    84: "MANAGE_OWN_CALLS",
    83: "SET_TIME_ZONE",
    82: "BIND_NFC_SERVICE",
    81: "MOUNT_FORMAT_FILESYSTEMS",
    80: "BROADCAST_PACKAGE_REMOVED",
    79: "INSTALL_SHORTCUT",
    78: "MASTER_CLEAR",
    77: "SIGNAL_PERSISTENT_PROCESSES",
    76: "SET_PROCESS_LIMIT",
    75: "SET_ANIMATION_SCALE",
    74: "BIND_TV_INPUT",
    73: "SET_DEBUG_APP",
    72: "INSTALL_LOCATION_PROVIDER",
    71: "SET_TIME",
    70: "BIND_INCALL_SERVICE",
    69: "SET_ALWAYS_FINISH",
    68: "DIAGNOSTIC",
    67: "LOCATION_HARDWARE",
    66: "GET_ACCOUNTS_PRIVILEGED",
    65: "READ_INPUT_STATE",
    64: "CAPTURE_AUDIO_OUTPUT",
    63: "BIND_AUTOFILL_SERVICE",
    62: "FACTORY_TEST",
    61: "WRITE_GSERVICES",
    60: "CHANGE_CONFIGURATION",
    59: "BATTERY_STATS",
    58: "CLEAR_APP_CACHE",
    57: "STATUS_BAR",
    56: "DEVICE_POWER",
    55: "FORCE_BACK",
    54: "MANAGE_ACCOUNTS",
    53: "MANAGE_APP_TOKENS",
    52: "SET_ACTIVITY_WATCHER"
}

# Updated Other Permissions with moved Missing Permissions
other_permissions = {
    118: "PACKAGE_USAGE_STATS",
    117: "USE_FULL_SCREEN_INTENT",
    116: "MANAGE_OWN_CALLS",             # Note: Already in Other, originally from Signature
    115: "READ_PRECISE_PHONE_STATE",
    114: "SCHEDULE_EXACT_ALARM",
    113: "MANAGE_MEDIA",
    112: "GET_TASKS",                    # Moved from Missing
    111: "BIND_REMOTEVIEWS",             # Moved from Missing
    110: "ACCESS_LOCATION_EXTRA_COMMANDS", # Moved from Missing
    109: "BIND_QUICK_SETTINGS_TILE",     # Moved from Missing
    108: "BIND_CHOOSER_TARGET_SERVICE",  # Moved from Missing
    107: "REQUEST_DELETE_PACKAGES",      # Moved from Missing
    106: "BIND_VOICE_INTERACTION",       # Moved from Missing
    105: "BIND_VR_LISTENER_SERVICE",     # Moved from Missing
    104: "BIND_VISUAL_VOICEMAIL_SERVICE",# Moved from Missing
    103: "BIND_MIDI_DEVICE_SERVICE",     # Moved from Missing
    102: "BIND_DREAM_SERVICE",           # Moved from Missing
    101: "START_VIEW_PERMISSION_USAGE",  # Moved from Missing
    100: "BIND_SCREENING_SERVICE",       # Moved from Missing
    99: "SMS_FINANCIAL_TRANSACTIONS",    # Moved from Missing
    98: "BIND_CONDITION_PROVIDER_SERVICE", # Moved from Missing
    97: "BIND_CARRIER_MESSAGING_SERVICE",# Moved from Missing
    96: "QUERY_ALL_PACKAGES",            # Moved from Missing
    95: "BIND_CALL_REDIRECTION_SERVICE", # Moved from Missing
    94: "BIND_TEXT_SERVICE",             # Moved from Missing
    93: "BIND_QUICK_ACCESS_WALLET_SERVICE", # Moved from Missing
    92: "BIND_CONTROLS",                 # Moved from Missing
    91: "INTERACT_ACROSS_PROFILES",      # Moved from Missing
    90: "INSTANT_APP_FOREGROUND_SERVICE",# Moved from Missing
    89: "SET_ALARM",                     # Moved from Missing
    88: "BIND_CARRIER_MESSAGING_CLIENT_SERVICE", # Moved from Missing
    87: "SEND_RESPOND_VIA_MESSAGE",      # Moved from Missing
    86: "WRITE_SYNC_SETTINGS",           # Moved from Missing
    85: "BIND_NOTIFICATION_LISTENER_SERVICE" # Moved from Missing
}

deprecated_permissions = {
    136: "RESTART_PACKAGES",
    135: "DISABLE_KEYGUARD",
    134: "BROADCAST_STICKY",
    133: "CHANGE_WIFI_MULTICAST_STATE",
    132: "PERSISTENT_ACTIVITY",
    131: "GLOBAL_SEARCH",
    130: "BROADCAST_PACKAGE_REMOVED",
    129: "INSTALL_SHORTCUT",
    128: "ACCESS_MOCK_LOCATION",
    127: "AUTHENTICATE_ACCOUNTS",
    126: "BRICK",
    125: "READ_PROFILE",
    124: "READ_SOCIAL_STREAM",
    123: "READ_USER_DICTIONARY",
    122: "SUBSCRIBED_FEEDS_READ",
    121: "SUBSCRIBED_FEEDS_WRITE",
    120: "UNINSTALL_SHORTCUT",
    119: "WRITE_PROFILE",
    118: "WRITE_SOCIAL_STREAM",
    117: "WRITE_USER_DICTIONARY"
}

# SHAP values dictionary for reference
shap_permissions = {
    "READ_PHONE_STATE": 0.04616946700528458,
    "SEND_SMS": 0.02187774218204911,
    "ACCESS_WIFI_STATE": 0.014380633326542156,
    "RECEIVE_BOOT_COMPLETED": 0.010743711367252655,
    "RECEIVE_SMS": 0.009963778648220773,
    "GET_TASKS": 0.00675744883664265,
    "WAKE_LOCK": 0.006365805401449124,
    "SYSTEM_ALERT_WINDOW": 0.003889635535013783,
    "ACCESS_FINE_LOCATION": 0.0038115117409104208,
    "WRITE_EXTERNAL_STORAGE": 0.0035379245693208275,
    "ACCESS_NETWORK_STATE": 0.0032464334751414843,
    "ACCESS_COARSE_LOCATION": 0.0032136085702733725,
    "GET_ACCOUNTS": 0.0030960455362850996,
    "READ_SMS": 0.0030804147145729968,
    "INTERNET": 0.0029260115322808635,
    "FOREGROUND_SERVICE": 0.001794846652186532,
    "BIND_DEVICE_ADMIN": 0.0012491074025562678,
    "CALL_PHONE": 0.0008693176350449721,
    "INSTALL_PACKAGES": 0.0006722039854199022,
    "MOUNT_UNMOUNT_FILESYSTEMS": 0.0006281267166742124,
    "READ_CONTACTS": 0.0005677016969015006,
    "WRITE_SETTINGS": 0.0005583446513888935,
    "READ_EXTERNAL_STORAGE": 0.0004925064330038046,
    "RECEIVE_WAP_PUSH": 0.0004689496845783457,
    "CHANGE_WIFI_STATE": 0.00045018305213642104,
    "VIBRATE": 0.00044012527112488093,
    "KILL_BACKGROUND_PROCESSES": 0.00042887776335123116,
    "READ_LOGS": 0.0004288582842201049,
    "CHANGE_NETWORK_STATE": 0.000373133238042871,
    "WRITE_CONTACTS": 0.0003144119067772414,
    "BIND_WALLPAPER": 0.00026960028445021885,
    "BIND_REMOTEVIEWS": 0.0002639280684059996,
    "RESTART_PACKAGES": 0.00025703752590705553,
    "CAMERA": 0.00023010969580488427,
    "SET_WALLPAPER": 0.0002256986407464153,
    "ACCESS_LOCATION_EXTRA_COMMANDS": 0.0001805433147701471,
    "WRITE_SYNC_SETTINGS": 0.00017256719424338268,
    "RECORD_AUDIO": 0.00015366327934512118,
    "PROCESS_OUTGOING_CALLS": 0.00014207386788895557,
    "MODIFY_AUDIO_SETTINGS": 0.0001257294779674433,
    "READ_SYNC_SETTINGS": 0.00012234864921941815,
    "BLUETOOTH": 0.00010674490478219526,
    "READ_CALENDAR": 0.00010450060739837746,
    "BIND_NOTIFICATION_LISTENER_SERVICE": 9.236496182316385e-05,
    "DISABLE_KEYGUARD": 8.397107443880096e-05,
    "BLUETOOTH_ADMIN": 8.103984987699054e-05,
    "BROADCAST_STICKY": 7.375107870742264e-05,
    "RECEIVE_MMS": 7.124625362044878e-05,
    "CLEAR_APP_CACHE": 6.807497980063887e-05,
    "STATUS_BAR": 6.499477045488749e-05,
    "CHANGE_CONFIGURATION": 5.615699800929405e-05,
    "BIND_CHOOSER_TARGET_SERVICE": 5.581241946409976e-05,
    "NFC": 5.470861716875707e-05,
    "BATTERY_STATS": 5.054279536275108e-05,
    "REQUEST_IGNORE_BATTERY_OPTIMIZATIONS": 5.037065594945846e-05,
    "MODIFY_PHONE_STATE": 4.6750056464507296e-05,
    "BIND_QUICK_SETTINGS_TILE": 4.626708431808902e-05,
    "WRITE_CALENDAR": 4.140852965903641e-05,
    "REBOOT": 4.105954451674047e-05,
    "CONTROL_LOCATION_UPDATES": 4.101590937093938e-05,
    "CHANGE_WIFI_MULTICAST_STATE": 3.8235944972204235e-05,
    "WRITE_APN_SETTINGS": 3.2770843281921085e-05,
    "ACCESS_NOTIFICATION_POLICY": 3.1401140816666006e-05,
    "USE_FINGERPRINT": 2.9492157284898056e-05,
    "DELETE_PACKAGES": 2.9030493398983394e-05,
    "PERSISTENT_ACTIVITY": 2.7956783480806018e-05,
    "WRITE_SECURE_SETTINGS": 2.7255098785412788e-05,
    "READ_SYNC_STATS": 2.7086540481140527e-05,
    "CALL_PRIVILEGED": 2.638921282027857e-05,
    "REORDER_TASKS": 2.4195979450079423e-05,
    "BIND_VPN_SERVICE": 2.387769438416057e-05,
    "BROADCAST_SMS": 2.3525468960847158e-05,
    "MANAGE_DOCUMENTS": 2.2963624274962636e-05,
    "EXPAND_STATUS_BAR": 2.284309905762217e-05,
    "GET_PACKAGE_SIZE": 2.277349318043306e-05,
    "BIND_ACCESSIBILITY_SERVICE": 2.2653117324154242e-05,
    "PACKAGE_USAGE_STATS": 2.0777356740962547e-05,
    "REQUEST_INSTALL_PACKAGES": 1.825396951958009e-05,
    "BROADCAST_WAP_PUSH": 1.8191372693977692e-05,
    "UPDATE_DEVICE_STATS": 1.7596459529877474e-05,
    "USE_BIOMETRIC": 1.657858362491495e-05,
    "ACCOUNT_MANAGER": 1.5533248492593058e-05,
    "READ_CALL_LOG": 1.47998070018077e-05,
    "DELETE_CACHE_FILES": 1.4658723849346837e-05,
    "BIND_INPUT_METHOD": 1.4363970561712579e-05,
    "SEND_RESPOND_VIA_MESSAGE": 1.4257583439521047e-05,
    "BIND_PRINT_SERVICE": 1.4127209425508314e-05,
    "SET_PREFERRED_APPLICATIONS": 1.1290204105626335e-05,
    "CHANGE_COMPONENT_ENABLED_STATE": 1.1157585756441824e-05,
    "BIND_APPWIDGET": 1.0831525750869422e-05,
    "GLOBAL_SEARCH": 1.0802276393638607e-05,
    "WRITE_CALL_LOG": 1.026064444440416e-05,
    "MEDIA_CONTENT_CONTROL": 9.656634243395491e-06,
    "BODY_SENSORS": 8.363012821080822e-06,
    "SET_WALLPAPER_HINTS": 8.3327354922372e-06,
    "REQUEST_DELETE_PACKAGES": 7.739392893515573e-06,
    "BIND_TELECOM_CONNECTION_SERVICE": 6.915810407193625e-06,
    "DUMP": 6.53814276130288e-06,
    "ACCESS_CHECKIN_PROPERTIES": 6.021255496943716e-06,
    "MANAGE_OWN_CALLS": 5.574001601422796e-06,
    "SET_TIME_ZONE": 5.4355025728710865e-06,
    "TRANSMIT_IR": 4.904996092402379e-06,
    "BIND_NFC_SERVICE": 3.885416365872403e-06,
    "USE_FULL_SCREEN_INTENT": 3.7950796748134033e-06,
    "BIND_VOICE_INTERACTION": 3.778709551716221e-06,
    "MOUNT_FORMAT_FILESYSTEMS": 3.5882722417405554e-06,
    "BROADCAST_PACKAGE_REMOVED": 3.49039410366341e-06,
    "INSTALL_SHORTCUT": 3.398412027153887e-06,
    "MASTER_CLEAR": 3.0638493751663753e-06,
    "SIGNAL_PERSISTENT_PROCESSES": 2.934828864507009e-06,
    "ANSWER_PHONE_CALLS": 2.8978084914773115e-06,
    "SET_PROCESS_LIMIT": 2.112340753920608e-06,
    "SET_ANIMATION_SCALE": 1.908307426229903e-06,
    "BIND_TV_INPUT": 1.5472939598909338e-06,
    "SET_DEBUG_APP": 1.5377350581306718e-06,
    "INSTALL_LOCATION_PROVIDER": 1.5072537420185573e-06,
    "SET_TIME": 1.4950549367166747e-06,
    "BIND_INCALL_SERVICE": 1.3606812513482034e-06,
    "ACCESS_BACKGROUND_LOCATION": 1.260205939938784e-06,
    "SET_ALWAYS_FINISH": 1.1316992335360054e-06,
    "DIAGNOSTIC": 8.626936030038468e-07,
    "LOCATION_HARDWARE": 7.805407079898966e-07,
    "READ_PHONE_NUMBERS": 7.676718465672224e-07,
    "ACTIVITY_RECOGNITION": 7.632621837490061e-07,
    "REQUEST_COMPANION_RUN_IN_BACKGROUND": 7.534081941221724e-07,
    "USE_SIP": 7.462982834331199e-07,
    "GET_ACCOUNTS_PRIVILEGED": 7.403137733089539e-07,
    "READ_INPUT_STATE": 7.304710363910927e-07,
    "CAPTURE_AUDIO_OUTPUT": 7.225097388734547e-07,
    "BIND_AUTOFILL_SERVICE": 7.169788830107271e-07,
    "FACTORY_TEST": 5.821537548861502e-07,
    "WRITE_GSERVICES": 6.180020001708615e-09,
    "ACCESS_MEDIA_LOCATION": 5.315985052767127e-10
}

# Priority weights for categories (Missing category removed)
priority_weights = {
    "Dangerous": 5,
    "Special": 4,
    "Signature": 3,
    "Normal": 2,
    "Other": 1,
    "Deprecated": 0
}

# Combine all permissions into a prioritized list (Missing category removed)
all_permissions = [
    ("Dangerous", dangerous_permissions),
    ("Special", special_permissions),
    ("Signature", signature_permissions),
    ("Normal", normal_permissions),
    ("Other", other_permissions),
    ("Deprecated", deprecated_permissions)
]

# Function to calculate global priority and display permissions
def display_prioritized_permissions():
    print("Android Permissions with Numerical Priority (Generated on March 15, 2025)\n")
    print("Prioritized based on SHAP values\n")
    for category, perms in all_permissions:
        print(f"{category} Permissions (Category Weight: {priority_weights[category]})")
        # Sort by priority in descending order
        sorted_perms = sorted(perms.items(), key=lambda x: x[0], reverse=True)
        for priority, perm in sorted_perms:
            # Calculate global priority: category weight * 1000 + individual priority
            global_priority = (priority_weights[category] * 1000) + priority
            shap_value = shap_permissions.get(perm, 0.0)
            # Check if the permission was moved from Missing
            comment = " (Moved from Missing)" if perm in [
                "GET_TASKS", "BIND_REMOTEVIEWS", "ACCESS_LOCATION_EXTRA_COMMANDS",
                "BIND_QUICK_SETTINGS_TILE", "BIND_CHOOSER_TARGET_SERVICE", "REQUEST_DELETE_PACKAGES",
                "BIND_VOICE_INTERACTION", "BIND_VR_LISTENER_SERVICE", "BIND_VISUAL_VOICEMAIL_SERVICE",
                "BIND_MIDI_DEVICE_SERVICE", "BIND_DREAM_SERVICE", "START_VIEW_PERMISSION_USAGE",
                "BIND_SCREENING_SERVICE", "SMS_FINANCIAL_TRANSACTIONS", "BIND_CONDITION_PROVIDER_SERVICE",
                "BIND_CARRIER_MESSAGING_SERVICE", "QUERY_ALL_PACKAGES", "BIND_CALL_REDIRECTION_SERVICE",
                "BIND_TEXT_SERVICE", "BIND_QUICK_ACCESS_WALLET_SERVICE", "BIND_CONTROLS",
                "INTERACT_ACROSS_PROFILES", "INSTANT_APP_FOREGROUND_SERVICE", "SET_ALARM",
                "BIND_CARRIER_MESSAGING_CLIENT_SERVICE", "SEND_RESPOND_VIA_MESSAGE", "WRITE_SYNC_SETTINGS",
                "BIND_NOTIFICATION_LISTENER_SERVICE"
            ] else ""
            print(f"  {global_priority:04d} - {perm} (SHAP: {shap_value:.10f}){comment}")
        print()

# Execute the display function
if __name__ == "__main__":
    display_prioritized_permissions()